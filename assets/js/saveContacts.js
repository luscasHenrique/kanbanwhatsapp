const saveContctsInit=async()=>{let e=await readLocalStorage("contatos");window.postMessage({request:"initContatos",contatos:e},"*")},saveContacts=()=>{let e=document.querySelector('[data-testid="conversation-info-header-chat-title"]').innerText;e=e.replaceAll("+","").replaceAll("-","").replaceAll(" ","");let t=document.querySelector('[data-testid="conversation-info-header"] > ._6u0RM');document.querySelector('[data-testid="conversation-info-header"] > ._6u0RM > ._3W2ap').setAttribute("style","flex-grow: 0.02;");let a=document.createElement("div");t.appendChild(a);var s="",l="",i=!1;/^\d+$/.test(e)?(s=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="20" height="20" x="0" y="0" viewBox="0 0 612 612" style="enable-background:new 0 0 512 512" xml:space="preserve" class="">
    <g>
        <path d="M269.272 310.198c86.177-.005 117.184-86.291 125.301-157.169C404.572 65.715 363.282 0 269.272 0 175.274 0 133.963 65.71 143.97 153.029c8.125 70.878 39.123 157.175 125.302 157.169z" fill="var(--panel-header-icon)" data-original="var(--panel-header-icon)" class=""></path>
        <path d="M457.707 346.115c2.773 0 5.528.083 8.264.235-4.101-5.85-8.848-11.01-14.403-15.158-16.559-12.359-38.005-16.414-56.964-23.864-9.229-3.625-17.493-7.226-25.251-11.326-26.184 28.715-60.329 43.736-100.091 43.74-39.749 0-73.891-15.021-100.072-43.74-7.758 4.101-16.024 7.701-25.251 11.326-18.959 7.451-40.404 11.505-56.964 23.864-28.638 21.375-36.039 69.46-41.854 102.26-4.799 27.076-8.023 54.707-8.964 82.209-.729 21.303 9.789 24.29 27.611 30.721 22.315 8.048 45.356 14.023 68.552 18.921 44.797 9.46 90.973 16.729 136.95 17.054 22.278-.159 44.601-1.956 66.792-4.833-16.431-23.807-26.068-52.645-26.068-83.695.001-81.451 66.264-147.714 147.713-147.714z" fill="var(--panel-header-icon)" data-original="var(--panel-header-icon)" class=""></path>
        <path d="M457.707 375.658c-65.262 0-118.171 52.909-118.171 118.171S392.444 612 457.707 612s118.172-52.909 118.172-118.171c-.001-65.263-52.91-118.171-118.172-118.171zm51.7 138.445h-31.425v31.424c0 11.198-9.077 20.276-20.274 20.276-11.198 0-20.276-9.078-20.276-20.276v-31.424h-31.424c-11.198 0-20.276-9.077-20.276-20.276 0-11.198 9.077-20.276 20.276-20.276h31.424v-31.424c0-11.198 9.078-20.276 20.276-20.276s20.274 9.078 20.274 20.276v31.424h31.425c11.198 0 20.276 9.078 20.276 20.276-.001 11.2-9.077 20.276-20.276 20.276z" fill="var(--panel-header-icon)" data-original="var(--panel-header-icon)" class=""></path>
    </g>
   </svg>`,l=language.saveCts_Title,i=!0):(s=`<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
    width="17pt" height="17pt" viewBox="0 0 64.000000 64.000000"
    preserveAspectRatio="xMidYMid meet">
   
   <g transform="translate(0.000000,64.000000) scale(0.100000,-0.100000)"
   fill="var(--panel-header-icon)" stroke="none">
   <path d="M136 554 c-8 -20 -8 -448 0 -468 11 -28 35 -18 111 45 l73 60 73 -60
   c76 -63 100 -73 111 -45 8 20 8 448 0 468 -5 14 -31 16 -184 16 -153 0 -179
   -2 -184 -16z"/>
   </g>
   </svg>`,l=language.saveCts_editCts),a.innerHTML=s,GFN.initTitle(a,l,"right"),a.addEventListener("click",t=>{closeEditDropdowns(),t.stopPropagation();let[a,s,l]=GFN.modal(!0),n=document.createElement("h1");i?n.innerHTML=language.saveCts_Title:n.innerHTML=language.saveCts_editCts,n.classList.add("waTidy_modal_heading"),s.appendChild(n);let o=document.createElement("input");o.placeholder=language.saveCts_placeholder,o.maxLength="35",i||(o.value=e),o.classList.add("waTidy_modal_input","waTidy_modal_user_tab_input"),s.appendChild(o);let c=document.createElement("div");c.style.display="flex",s.appendChild(c);let r=document.createElement("button");r.classList.add("waTidy_modal_button","waTidy_agendar_btn"),r.innerHTML=language.save,r.addEventListener("click",()=>{d(o.value,a)}),c.appendChild(r)});let d=async(e,t)=>{if(e.length<3){GFN.notificacao("error","Nome n\xe3o pode ser menor que 3 letras");return}let s=await GFN.Wpp_Request("getActiveChat","id");console.log(s);let l={id:s,name:e},i=await readLocalStorage("contatos");if(await GFN.isFree()&&i.length>5){t?.remove(),GFN.modalPremium(!1,language.saveCts_free);return}window.postMessage({request:"save_editContato",contato:l},"*"),(i=i.filter(e=>e.id!=s)).push(l),chrome.storage.local.set({contatos:i}),document.querySelector('[data-testid="conversation-info-header-chat-title"]').innerHTML=e,a.innerHTML=`<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
    width="17pt" height="17pt" viewBox="0 0 64.000000 64.000000"
    preserveAspectRatio="xMidYMid meet">
   
   <g transform="translate(0.000000,64.000000) scale(0.100000,-0.100000)"
   fill="var(--panel-header-icon)" stroke="none">
   <path d="M136 554 c-8 -20 -8 -448 0 -468 11 -28 35 -18 111 45 l73 60 73 -60
   c76 -63 100 -73 111 -45 8 20 8 448 0 468 -5 14 -31 16 -184 16 -153 0 -179
   -2 -184 -16z"/>
   </g>
    </svg>`,t?.remove(),chrome.runtime.sendMessage({action:"userUpdateNome",contato:l})}},buttonsWhatsapp_Watidy_Acao=(e,t,a,s,l,i)=>{let d=document.querySelector("div._3WByx"),n=document.querySelector("div._604FD"),o=document.querySelector("div._3gYev"),c=document.querySelector("#pane-side");a.addEventListener("click",()=>{whatsapp_Chat(e,t,d,n,o,c,l,i)}),s.addEventListener("click",()=>{watidy_Contats(e,t,d,n,o,c,l,i)})},whatsapp_Chat=(e,t,a,s,l,i,d,n)=>{d.classList.add("d-none"),n.style.display="none",t.style.display="none",e.style.display="none",document.querySelector(".ctsSelecionados").classList.add("d-none"),document.querySelector(".opcaoContatos").classList.remove("d-none"),document.querySelector("#pes_watidy").classList.remove("d-none"),document.querySelector(".slcTodos").classList.add("d-none");let o=document.querySelectorAll("#side > div");o[0].classList.remove("d-none"),i.style.display="block",a.style.display="block",s.style.display="block";document.querySelector("#chatWatidy").innerHTML=""},watidy_Contats=async(e,t,a,s,l,i,d,n)=>{let o=document.querySelectorAll("#side > div");o[0].classList.add("d-none"),i.style.display="none",a.style.display="none",s.style.display="none",t.style.display="flex",e.style.display="grid",d.classList.remove("d-none"),n.style.display="block",is_Select(!1,e,document.querySelector(".opcaoRadio")),is_active(0,document.querySelectorAll(".marcador"));let c=await readLocalStorage("contatos");window.postMessage({action:"btnsFuncao",models:c,campanha:!1},"*")},clearSelect=()=>{let e=document.getElementsByClassName("cts");for(let t=0;t<e.length;t++){let a=e[t],s=a.querySelector(".watidyChat > ._1-gER > div > div");s.classList.add("radioSaveCts");let l=a.querySelector(".watidyChat > ._1-gER > div > div > div");l.classList.add("d-none"),a.classList.remove("_atv")}},actionSelecionados=()=>{let e=document.querySelector("#ctsSelect"),t=document.querySelector("#ctsDestino"),a=async()=>{t.innerHTML="";let e=await readLocalStorage("userTabs");console.log(e),e.forEach(e=>{let a=document.createElement("option");a.innerText=e.tag,a.value=e.tag,t.appendChild(a),t.dispatchEvent(new Event("change"))})},s=()=>{Swal.fire({icon:"error",title:"Oops...",text:language.swalNotWhatsapp})};e.dispatchEvent(new Event("change")),e.addEventListener("change",()=>{"Abas"===e.value?a():!0===whats_isBusines?window.postMessage({action:"ctsEtiquetas"},"*"):s()}),a()},selectContatos=e=>{let t=document.querySelectorAll(".watidyChat"),a=document.querySelector(".opcaoContatos"),s=document.querySelector(".ctsSelecionados"),l=document.querySelector("#pes_watidy"),i=document.querySelector("div.slcTodos");"selectAll"==e.attributes.data.value?(e.setAttribute("src",chrome.runtime.getURL("assets/images/svgs/close.svg")),e.setAttribute("data","close"),e.title=language.contatos_closeSelect,s.classList.remove("d-none"),a.classList.add("d-none"),l.classList.add("d-none"),i.classList.remove("d-none"),t.forEach(e=>{e.querySelector("._1-gER").classList.remove("d-none");e.querySelector("._199zF._3j691._2N1Gm").classList.remove("p-0px")})):(e.setAttribute("src",chrome.runtime.getURL("assets/images/svgs/selectAll.svg")),e.setAttribute("data","selectAll"),e.title=language.watidy_cts_selectAll_Title,s.classList.add("d-none"),a.classList.remove("d-none"),l.classList.remove("d-none"),i.classList.add("d-none"),t.forEach(e=>{e.querySelector("._1-gER").classList.add("d-none");e.querySelector("._199zF._3j691._2N1Gm").classList.add("p-0px")})),clearSelect()},salvarSelecionados=async(e,t)=>{let a=document.querySelectorAll("div._atv");if(0===a.length){Swal.fire({icon:"error",title:"Oops...",text:language.salvarCts_selecionados});return}if("Abas"===e.value){let s=await readLocalStorage("userTabs"),l=[];s.forEach(e=>{e.tag===t.value&&(a.forEach(t=>{e.chats.push(t.attributes.index.value)}),l=e.chats.filter((t,a)=>e.chats.indexOf(t)===a),e.chats=[],e.chats=l)}),chrome.storage.local.set({userTabs:s},()=>init()),Swal.fire({position:"center",icon:"success",title:language.ctsAdicionadoAba,showConfirmButton:!1,timer:1500})}else if("Etiquetas"===e.value){let i=[];if(a.forEach(e=>{i.push(e.attributes.index.value)}),i.length>100){Swal.fire({position:"center",icon:"error",title:language.etiquetaCtsError,showConfirmButton:!0});return}let d=document.querySelector("#app");d.classList.add("d-none");let n=document.createElement("div");n.setAttribute("id","loadEtiquetas");let o=document.createElement("div"),c=document.createElement("p");c.innerHTML=language.etiquetaVinculando;let r=document.createElement("div");r.classList.add("loading","loadEtc"),o.appendChild(r),o.appendChild(c),n.appendChild(o),document.body.appendChild(n),window.postMessage({action:"AllCtsEtiquetas",selectCts:i,eti:t.value},"*")}document.querySelector("#selectImg").click()},initWatidyContacts=(e,t)=>{clearInterval(e);let a=document.querySelector('[data-testid="chatlist-header"]'),s=document.createElement("div");s.classList.add("watidyHeaderContats");let l=document.createElement("span");l.innerHTML='<svg viewBox="0 0 24 24" height="24" width="24" preserveAspectRatio="xMidYMid meet" class="" version="1.1" x="0px" y="0px" enable-background="new 0 0 24 24" xml:space="preserve"><path fill="currentColor" d="M12,4l1.4,1.4L7.8,11H20v2H7.8l5.6,5.6L12,20l-8-8L12,4z"></path></svg>',l.style.cursor="pointer";let i=document.createElement("h1");i.innerHTML=language.watidyCtsTitulo,i.classList.add("watidyHeaderTitulo"),s.appendChild(l),s.appendChild(i),a.appendChild(s);let d=document.querySelector("#side"),n=document.createElement("div");n.classList.add("opcaoContatos");let o=[];for(let c=0;c<=3;c++)o[c]=document.createElement("hr"),o[c].classList.add("marcador");let r=document.createElement("div");r.classList.add("opcaoTodos");let $=document.createElement("button");$.setAttribute("id","todosBtn"),$.classList.add("menu_text","opcaoContatosBtns"),$.innerHTML=language.todos,o[0].style.backgroundColor="var(--waTidy-primary)",r.appendChild($),r.appendChild(o[0]);let _=document.createElement("div");_.classList.add("opcaoGrupos");let p=document.createElement("button");p.classList.add("menu_text","opcaoContatosBtns"),p.setAttribute("id","gruposBtn"),p.innerHTML=language.ctsDeGrupos,_.appendChild(p),_.appendChild(o[1]);let v=document.createElement("div");v.classList.add("opcaoAbas");let u=document.createElement("button");u.classList.add("menu_text","opcaoContatosBtns"),u.setAttribute("id","abasBtn"),u.innerHTML=language.ctsDeAbas,v.appendChild(u),v.appendChild(o[2]);let h=document.createElement("div");h.classList.add("opcaoSalvos"),h.style.margin="auto";let y=document.createElement("button");y.classList.add("menu_text","opcaoContatosBtns"),y.setAttribute("id","salvosBtn"),y.innerHTML=language.ctsSalvos,h.appendChild(y),h.appendChild(o[3]);let g=document.createElement("div");g.classList.add("opcaoRadio"),n.appendChild(h),n.appendChild(r),n.appendChild(_),n.appendChild(v),n.appendChild(g),d.appendChild(n);let m=document.createElement("div");m.classList.add("d-none","mainPesquisa");let C=document.createElement("div");C.classList.add("divSelect");let L=document.createElement("img");L.setAttribute("id","selectImg"),L.classList.add("selectAllImg","d-none"),L.setAttribute("src",chrome.runtime.getURL("assets/images/svgs/selectAll.svg")),L.setAttribute("data","selectAll"),L.addEventListener("click",()=>{selectContatos(L)});let b=document.createElement("div");b.setAttribute("id","loadSelect"),b.classList.add("loading","l-select"),C.appendChild(b),C.appendChild(L);let w=document.createElement("div");w.classList.add("_pesqSelect"),w.innerHTML=`<div tabindex="-1" class="_3gYev" id='pes_watidy'>
    <div class="_3wQ5i _1s7Pa" data-testid="chat-list-search-container">
      <div class="_1EUay">
        <button data-testid="icon-search-morph" class="opCKJ _28iyj" aria-label="Pesquisar ou come\xe7ar uma nova conversa">
          <div class="_3xdht _2hW8J">
            <span data-testid="back" data-icon="back" class="">
              <svg viewBox="0 0 24 24" width="24" height="24" class="">
                <path fill="currentColor" d="m12 4 1.4 1.4L7.8 11H20v2H7.8l5.6 5.6L12 20l-8-8 8-8z"></path>
              </svg>
            </span>
          </div>
          <div class="_3xdht _1ZD3q">
            <span data-testid="search" data-icon="search" class="">
              <svg viewBox="0 0 24 24" width="24" height="24" class="svgLupa">
                <path fill="currentColor" d="M15.009 13.805h-.636l-.22-.219a5.184 5.184 0 0 0 1.256-3.386 5.207 5.207 0 1 0-5.207 5.208 5.183 5.183 0 0 0 3.385-1.255l.221.22v.635l4.004 3.999 1.194-1.195-3.997-4.007zm-4.808 0a3.605 3.605 0 1 1 0-7.21 3.605 3.605 0 0 1 0 7.21z"></path>
              </svg>
            </span>
          </div>
        </button>
        <span></span>
       
        <div class="_2vDPL">
        <div tabindex="-1" class="_3RN1i _3jaYl">
            <input id="pesquisaChat" type="text" placeholder="Pesquisar">
        </div>
        </div> 

        </div>
      </div>
    </div>
    </div>`;let E=document.createElement("div");E.classList.add("slcTodos","d-none");let S=document.createElement("button");S.setAttribute("id","slcTodosWa"),S.innerHTML=language.watidy_cts_selectAll,S.classList.add("waTidy_select_all_chats_btn"),E.appendChild(S),w.appendChild(E);let q=document.createElement("div");q.classList.add("ctsSelecionados","d-none");let M=document.createElement("p");M.innerHTML=language.ctsDesc;let T=document.createElement("select");T.classList.add("selectHub"),T.setAttribute("id","ctsSelect");let A=document.createElement("option");A.innerHTML=language.Abas,T.appendChild(A);let x=document.createElement("option");x.innerHTML=language.Etiquetas,T.appendChild(x);let f=document.createElement("select");f.classList.add("selectHub"),f.setAttribute("id","ctsDestino");let k=document.createElement("button");k.innerHTML=language.save,k.addEventListener("click",()=>{salvarSelecionados(T,f)}),q.appendChild(M),q.appendChild(T),q.appendChild(f),q.appendChild(k),m.appendChild(w),m.appendChild(C);let H=document.createElement("div");H.setAttribute("id","chatlist"),H.innerHTML=`<div class="g0rxnol2 _3fGK2" style="display: block;overflow: hidden;">
    <div tabindex="-1" data-tab="4">
      <div class="" data-testid="chat-list" id="chatList">
        <div class="_3uIPm WYyr1" role="grid" aria-rowcount="512" style="height: 36864px;" id="chatWatidy"></div>
      </div>
    </div>
  </div>`,H.style.display="none",H.style.overflow="auto",d.appendChild(m),d.appendChild(q),d.appendChild(H),$.addEventListener("click",()=>{is_Select(!1,n,g),is_active(0,o),window.postMessage({action:"closeWatidyContacts"},"*"),window.postMessage({action:"getAllContactsData",campanha:!1},"*")}),p.addEventListener("click",()=>{is_Select(!0,n,g),is_active(1,o),window.postMessage({action:"closeWatidyContacts"},"*"),window.postMessage({action:"renderGroupWatidyContatos"},"*")}),u.addEventListener("click",()=>{is_Select(!0,n,g),is_active(2,o),window.postMessage({action:"closeWatidyContacts"},"*"),window.postMessage({action:"renderTabsWatidyContatos"},"*")}),y.addEventListener("click",async()=>{is_Select(!1,n,g),is_active(3,o);let e=await readLocalStorage("contatos");window.postMessage({action:"closeWatidyContacts"},"*"),window.postMessage({action:"contatosSalvos",models:e},"*")}),buttonsWhatsapp_Watidy_Acao(n,s,l,t,m,H);let W=document.querySelector("#pesquisaChat");W.addEventListener("keyup",()=>{window.postMessage({action:"pesquisaChat",pesquisa:W.value},"*")}),actionSelecionados()},is_active=(e,t)=>{document.querySelector("#pesquisaChat").value="",0===e?(t[0].style.backgroundColor="var(--waTidy-primary)",t[1].style.backgroundColor="",t[2].style.backgroundColor="",t[3].style.backgroundColor=""):1===e?(t[0].style.backgroundColor="",t[1].style.backgroundColor="var(--waTidy-primary)",t[2].style.backgroundColor="",t[3].style.backgroundColor=""):2===e?(t[0].style.backgroundColor="",t[1].style.backgroundColor="",t[2].style.backgroundColor="var(--waTidy-primary)",t[3].style.backgroundColor=""):3===e&&(t[0].style.backgroundColor="",t[1].style.backgroundColor="",t[2].style.backgroundColor="",t[3].style.backgroundColor="var(--waTidy-primary)")},is_Select=(e,t,a)=>{!0==e?(t.style.gridTemplateRows="repeat(2, 1fr)",a.style.display="block"):!1==e&&(t.style.gridTemplateRows="repeat(1, 1fr)",a.style.display="none")};