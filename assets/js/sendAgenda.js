var btnTexto=document.createElement("button"),btnMedia=document.createElement("label"),mainContainer=document.createElement("div");mainContainer.setAttribute("id","mainContainer");var createScript=document.createElement("div");createScript.setAttribute("id","creteScript");const createScriptID=document.querySelector("#creteScript");var tituloScript=document.createElement("input"),messageRapidas=document.createElement("textarea"),addMais=document.createElement("button"),previewName=document.createElement("abbr");previewName.setAttribute("id","previewName");var voltar=document.createElement("img");voltar.setAttribute("id","voltar");var guarda=document.createElement("button"),typeGuarda="",heading=document.createElement("h1");const resetMensagensRapidasModel=(e,t)=>{t.innerHTML="";let a=document.createElement("button");a.classList.add("waTidy_modal_close_btn"),a.addEventListener("click",()=>{e.remove()}),t.appendChild(a)},renderMensagensRapidas=async(e,t,a)=>{e.stopPropagation(),t.setAttribute("id","modalDivMsgRapidas"),resetMensagensRapidasModel(t,a),voltar.setAttribute("src",chrome.runtime.getURL("assets/images/svgs/voltar.svg")),voltar.classList.add("copy"),voltar.style.display="none",voltar.style.width="25px",a.style.width="42rem",a.style.height="60rem",(searchInput=document.createElement("input")).classList.add("waTidy_modal_input","waTidy_modal_user_tab_input"),searchInput.style.margin="0",searchInput.style.width="95%",searchInput.style.height="1em",searchInput.addEventListener("keyup",()=>filterListMsgRapidas()),searchInput.setAttribute("id","searchInputMsgRapidas"),searchInput.setAttribute("type","text"),searchInput.setAttribute("autocomplete","off"),searchInput.setAttribute("placeholder",language.sendAgenda_placeholder),mainContainer.innerHTML="",mainContainer.classList.add("campaign_one_container"),mainContainer.style.display="block";let s=await readLocalStorage("guardaMsg"),l=setInterval(d,100);function d(){let e=s.filter(e=>e).reverse();if(0==e.length){let t=document.createElement("div");t.setAttribute("id","msgRapidoEmptyMsg");let a=document.createElement("p");a.innerText=language.agenda_empty,t.appendChild(a),mainContainer.appendChild(t)}else e.forEach(t=>{console.log(e),n(t,e)});clearInterval(l)}function n(e,t){let a=document.createElement("div");a.classList.add("waTidy_note_item");let s=document.createElement("p");s.style.textAlign="start",s.innerText=e.titulo;let l=document.createElement("div");l.setAttribute("style","margin-left: 0.3rem;display: flex;");let d=document.createElement("span");d.classList.add("delIcon"),GFN.svg(d,chrome.runtime.getURL("assets/images/svgs/tab_delete.svg")),d.addEventListener("click",()=>delMsgRapida(e.id,a)),d.style.cursor="pointer";let n=document.createElement("img");n.setAttribute("src",chrome.runtime.getURL("assets/images/svgs/tab_rename.svg")),n.addEventListener("click",()=>editMsgRapida(e,t)),n.classList.add("copy"),l.appendChild(n),l.appendChild(d),a.appendChild(s),a.appendChild(l),mainContainer.appendChild(a)}addMais.innerHTML=language.sendAgenda_addMais,addMais.classList.add("addMais"),addMais.style.display="",createScript.innerHTML="",createScript.classList.add("createScript"),createScript.style.display="none";let r=document.createElement("div");r.style.textAlign="initial",r.classList.add("scriptDiv1"),tituloScript.classList.add("waTidy_modal_input","waTidy_modal_user_tab_input"),tituloScript.setAttribute("placeholder",language.createMsgRapidas_Titulo),tituloScript.setAttribute("type","text"),tituloScript.style.width="88%",tituloScript.style.marginLeft="0.5rem";let p=document.createElement("div");p.classList.add("scriptDiv2");let o=document.createElement("div");o.style.margin="0.5rem 0rem 0rem 0.5rem",o.style.width="555px",o.classList.add("msgContainer");let c=document.createElement("div");c.classList.add("emojipicker-container"),heading.classList.add("waTidy_modal_heading"),heading.innerText=language.respostasRapidas,heading.style.marginBottom="1.2rem",a.style.textAlign="center",messageRapidas.style.fontSize="1rem",messageRapidas.style.fontFamily="inherit",messageRapidas.setAttribute("rows","10"),messageRapidas.classList.add("waTidy_modal_input","waTidy_reminder_input"),messageRapidas.setAttribute("placeholder",language.create_link_message_placeholder),messageRapidas.setAttribute("data-meteor-emoji",!0),messageRapidas.style.margin="0px";let m=document.createElement("img");m.setAttribute("id","preview"),m.classList.add("preview");let g=document.createElement("div");g.classList.add("scriptDiv3");let y=document.createElement("h2");y.classList.add("tipoDeEnvios"),y.innerHTML=language.tipo,(btnTexto=document.createElement("button")).setAttribute("id","btnTexto"),btnTexto.data=1,btnTexto.style.margin="1rem 0rem 2rem 0rem",btnTexto.innerHTML=language.texto;let u=document.createElement("input");function v(e){return file=e}u.setAttribute("id","mediaUpload"),u.setAttribute("type","file"),u.setAttribute("name","mediaUpload"),btnMedia.setAttribute("id","btnMedia"),btnMedia.data=2,btnMedia.setAttribute("for","mediaUpload"),btnMedia.innerHTML=language.media,r.appendChild(tituloScript),createScript.appendChild(r),p.appendChild(o),previewName.appendChild(m),o.appendChild(previewName),o.appendChild(c),c.appendChild(messageRapidas),createScript.appendChild(p),g.appendChild(y),g.appendChild(btnTexto),g.appendChild(btnMedia),g.appendChild(u),createScript.appendChild(g),u.addEventListener("change",function(){let e=document.querySelector("#mediaUpload");e.type="file";let t=(nameFile=e.files[0]).type;if(nameFile=nameFile.name,previewName.title=nameFile,this.files&&this.files[0]){var a=new FileReader;a.onload=function(e){t=t.split("/"),document.getElementById("preview").style.display="inline-flex","image"==t[0]?document.getElementById("preview").src=e.target.result:document.getElementById("preview").src="https://watidy.com.br/imagens/file.jpg"},a.readAsDataURL(this.files[0])}var s,a=e.files[0];(s=a,new Promise((e,t)=>{let a=new FileReader;a.readAsDataURL(s),a.onload=()=>e(a.result),a.onerror=e=>t(e)})).then(e=>{v(e)})}),addCheckTexto(),btnTexto.addEventListener("click",function(){document.getElementById("preview").style.display="none",document.querySelector("#mediaUpload").value=null,removeCheckALl(),addCheckTexto(),y="texto",file="NULL"}),btnMedia.addEventListener("click",function(){removeCheckALl(),addCheckMedia(),y="media"}),guarda.innerHTML=language.save,guarda.classList.add("waTidy_modal_button","waTidy_note_btn"),guarda.style.display="none",addMais.addEventListener("click",function(){tituloScript.value="",messageRapidas.value="",file="NULL",typeGuarda="addMais",removeCheckALl(),addCheckTexto(),document.getElementById("preview").style.display="none",searchInput.style.display="none",mainContainer.style.display="none",addMais.style.display="none",a.style.height="29rem",guarda.style.display="block",heading.innerText=language.respostasRapidasNew,createScript.style.display="grid"});let h=()=>{let e="NULL";if("NULL"!=file){let t=document.querySelector("#mediaUpload");e=t.files[0].name}guardaMensagemRapida(tituloScript.value,messageRapidas.value,file,e),tituloScript.value="",messageRapidas.value="",searchInput.style.display="block",mainContainer.style.display="block",addMais.style.display="initial",a.style.height="60rem",guarda.style.display="none",heading.innerText=language.respostasRapidasNew,createScript.style.display="none"};guarda.addEventListener("click",function(){"addMais"===typeGuarda&&h()}),a.appendChild(voltar),a.appendChild(heading),a.appendChild(searchInput),a.appendChild(mainContainer),a.appendChild(createScript),a.appendChild(guarda),a.appendChild(addMais),t.appendChild(a),document.body.appendChild(t)},delMsgRapida=async(e,t)=>{let a=await readLocalStorage("guardaMsg");if(a=a.filter(t=>t.id!=e),chrome.storage.local.set({guardaMsg:a},()=>{t.remove()}),0==a.length){let s=document.createElement("div");s.setAttribute("id","notesEmptyMsg"),s.style.textAlign="center";let l=document.createElement("p");l.innerText=language.notes_empty,s.appendChild(l),document.querySelector("#mainContainer").appendChild(s)}resetMsgRapidas()},guardaMensagemRapida=async(e,t,a,s)=>{if(""==e.trim())return;let l=await readLocalStorage("guardaMsg"),d={id:Date.now(),titulo:e,texto:t,file:a,nameFile:s};l.push(d),chrome.storage.local.set({guardaMsg:l},()=>{document.querySelector("#msgRapidoEmptyMsg")?.remove();let e=document.createElement("div");e.classList.add("waTidy_note_item");let t=document.createElement("p");t.style.textAlign="start",t.innerText=d.titulo;let a=document.createElement("div");a.setAttribute("style","margin-left: 0.3rem;display: flex;");let s=document.createElement("span");s.classList.add("delIcon"),GFN.svg(s,chrome.runtime.getURL("assets/images/svgs/tab_delete.svg")),s.addEventListener("click",()=>delMsgRapida(note.id,e)),s.style.cursor="pointer";let n=document.createElement("img");n.setAttribute("src",chrome.runtime.getURL("assets/images/svgs/tab_rename.svg")),n.addEventListener("click",()=>editMsgRapida(d,l)),n.classList.add("copy"),a.appendChild(n),a.appendChild(s),e.appendChild(t),e.appendChild(a),mainContainer.prepend(e)}),resetMsgRapidas()},filterListMsgRapidas=()=>{var e,t,a;if(t=(e=document.getElementById("searchInputMsgRapidas")).value.toUpperCase(),a=document.getElementsByClassName("waTidy_note_item"),""==t.trim()){console.log("vazio");for(let s=0;s<a.length;s++)a[s].style.display=""}else for(console.log("PREENCHIDO"),i=0;i<a.length;i++)(txtValue=a[i].querySelector("p").innerHTML).toUpperCase().indexOf(t)>-1?a[i].style.display="":a[i].style.display="none"},filterMsg=()=>{var e,t,a;if(t=(e=document.getElementById("pesquisaMsg")).value.toUpperCase(),a=document.getElementsByClassName("listContent"),console.log(a),""==t.trim()){console.log("vazio");for(let s=0;s<a.length;s++)a[s].style.display=""}else for(i=0;i<a.length;i++)(txtValue=a[i].querySelector(".tituloDiv2").innerHTML).toUpperCase().indexOf(t)>-1?a[i].style.display="":a[i].style.display="none"},editMsgRapida=async(e,t)=>{typeGuarda="editMsg",file="NULL";let a=await readLocalStorage("guardaMsg");a=a.filter(t=>t.id!=e.id),console.log(a);let s=document.querySelector("#contentMsgRapidas"),l=document.querySelector("#creteScript");if(tituloScript.value="",messageRapidas.value="",removeCheckALl(),addCheckTexto(),searchInput.style.display="none",document.querySelector("#mainContainer").style.display="none",addMais.style.display="none",s.style.height="28rem",s.style.overflow="hidden",voltar.style.display="block",guarda.style.display="block",heading.innerText=language.respostasRapidasEdit,l.style.display="grid","NULL"!==e.file){previewName.title=e.nameFile;let d=e.file;"data:image"!==(d=d.split("/"))[0]?document.getElementById("preview").src="https://watidy.com.br/imagens/file.jpg":document.getElementById("preview").src=e.file,document.getElementById("preview").style.display="inline-flex",removeCheckALl(),addCheckMedia()}else removeCheckALl(),addCheckTexto(),document.getElementById("preview").style.display="none";tituloScript.value=e.titulo,messageRapidas.value=e.texto,voltar.addEventListener("click",function(){voltarMain(s,l)});let n=()=>{console.log(file);let t=document.querySelector(".btnCheck").data,s=file;if(nameFile="NULL",1===t?s="NULL":("NULL"===s&&(s=e.file),nameFile=document.querySelector("#previewName").title),""==messageRapidas.value.trim())return;let l={id:Date.now(),titulo:tituloScript.value,texto:messageRapidas.value,file:s,nameFile:nameFile};console.log("OK"),a.push(l),chrome.storage.local.set({guardaMsg:a},()=>{console.log(a)}),l="",a="",document.querySelector("#modalDivMsgRapidas")?.remove()};guarda.addEventListener("click",function(){"editMsg"===typeGuarda&&(n(),resetMsgRapidas())})};function voltarMain(e,t){let a=document.querySelector("#voltar");searchInput.style.display="block",document.querySelector("#mainContainer").style.display="block",addMais.style.display="initial",document.querySelector("#contentMsgRapidas").style.height="60rem",a.style.display="none",guarda.style.display="none",heading.innerText=language.respostasRapidasNew,document.querySelector("#creteScript").style.display="none"}function removeCheckALl(){btnTexto.classList.remove("btnNot"),btnTexto.classList.remove("btnCheck"),btnMedia.classList.remove("btnNot"),btnMedia.classList.remove("btnCheck")}function addCheckTexto(){btnTexto.classList.add("btnCheck"),btnMedia.classList.add("btnNot")}function addCheckMedia(){btnTexto.classList.add("btnNot"),btnMedia.classList.add("btnCheck")}const resetMsgRapidas=()=>{document.querySelector(".mensageRapidas")?.remove(),msgRapidas=loadMsg(),main_Three(),document.querySelector("div._2Ts6i._1xFRo").style.flex="0 0 18.1%",document.querySelector(".mensageRapidas").style.display="block",document.querySelector("div._2Ts6i._1xFRo > .lhggkp7q.qq0sjtgm.ebjesfe0.jxacihee.tkdu00h0").style.display="none"};setInterval(async()=>{let e=await readLocalStorage("agendaMsg");var t=[],a=[],s=e,l=0;if(0!==e.length){let d=new Date,n=String(d.getDate()).padStart(2,"0"),r;d=`${String(d.getMonth()+1).padStart(2,"0")}/${n}/${d.getFullYear()}`,d=new Date(d);for(let p=0;p<e.length;p++){let o=e[p].data;(o=new Date(o)).setDate(o.getDate()+1);let c=String(o.getDate()).padStart(2,"0"),m;o=`${String(o.getMonth()+1).padStart(2,"0")}/${c}/${o.getFullYear()}`,o=new Date(o);let g=Math.abs(d-o);if(0==(g/=864e5)){let y=new Date;var u=y.getHours(),v=y.getMinutes();y=`${u}${v}`;let h=e[p].timer.split(":"),b=parseInt(h[0]),L=parseInt(h[1]),M=60*b+L-(60*u+v);M>=-5&&M<=5&&(t[l]=e[p].text,a[l]=e[p].userID,s=s.filter(t=>t.id!=e[p].id),l++)}}}window.postMessage({action:"dispararAgenda",msg:t,tell:a},"*"),chrome.runtime.sendMessage({action:"updateContNotas",userID:a[0]}),chrome.storage.local.set({agendaMsg:s}),t=[],a=[]},21e4);