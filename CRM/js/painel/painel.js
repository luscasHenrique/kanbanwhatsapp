const painel=async e=>{GFN.isBussines=await WPP("isBusiness"),GFN.isBussines&&(GFN.labels=await WPP("labels"));let t=document.createElement("div");t.classList.add("main"),e.appendChild(t),injectPainel.menu(t),injectPainel.content(t),Swal.fire({title:GFN.language.Atencao,text:GFN.language.CRM_alert_Modulo,icon:"warning",confirmButtonColor:"#3085d6",confirmButtonText:"Entendi"})},injectPainel={menu(e){let t=document.createElement("div");t.classList.add("menu"),e.appendChild(t);let a=document.createElement("div");a.classList.add("logo"),t.appendChild(a);let l=document.createElement("img");l.setAttribute("src","../assets/images/icons/WaTidy 40 x 40.png"),a.appendChild(l);let n=document.createElement("div");n.classList.add("list-menu"),t.appendChild(n),["addAba","menuAbas","peformace","lupaMais","lupaMenos"].forEach(e=>{let t=document.createElement("div");switch(GFN.svg(t,`./img/${e}.svg`),n.appendChild(t),e){case"addAba":t.addEventListener("click",()=>{menuBar.addAba()}),GFN.initTitle(t,GFN.language.CRM_newAba,"right");break;case"menuAbas":t.addEventListener("click",()=>{menuBar.menuAbas()}),GFN.initTitle(t,GFN.language.tab_settings_heading,"right");break;case"peformace":t.addEventListener("click",()=>{menuBar.confPeformace()}),GFN.initTitle(t,GFN.language.CRM_confPeformace,"right");break;case"lupaMais":t.addEventListener("click",()=>{menuBar.lupa(10)}),GFN.initTitle(t,GFN.language.CRM_lupaMais,"right");break;case"lupaMenos":t.addEventListener("click",()=>{menuBar.lupa(-10)}),GFN.initTitle(t,GFN.language.CRM_lupaMenos,"right")}})},async content(e){let t=document.createElement("div");t.classList.add("crm"),e.appendChild(t);let a=await GFN.getStorage("zoomCRM");a=a.zoomCRM;let l=document.createElement("div");l.setAttribute("style",`zoom:${a}%;`),l.classList.add("content"),t.appendChild(l),controler.sortableAbas(l),injectPainel.allCts(l),injectPainel.abas(l)},async allCts(e){let t=document.createElement("div");t.classList.add("aba-Content"),t.setAttribute("data-id","inbox"),e.appendChild(t),injectPainel.header(t,!0,"Inbox",null);let a=document.createElement("div");a.classList.add("list-contatos","inbox"),t.appendChild(a),controler.updateInbox(),controler.sortableInboxUsers(a)},header(e,t,a,l){let n=document.createElement("div");n.classList.add("aba-header"),e.appendChild(n);let i=document.createElement("div");i.classList.add("aba-nomeAba"),n.appendChild(i);let d=document.createElement("h2");if(d.setAttribute("aba-name",""),a.length>18?d.innerHTML=a.slice(0,15)+"...":d.innerHTML=a,i.appendChild(d),!t){let s=document.createElement("span");s.setAttribute("tag","tam-aba"),s.innerHTML=l,i.appendChild(s)}let r=document.createElement("div");r.classList.add("aba-config"),n.appendChild(r);let c=document.createElement("div");r.appendChild(c);let o=document.createElement("span");c.appendChild(o),GFN.svg(o,"./img/pesquisar.svg");let p=document.createElement("div");r.appendChild(p),GFN.svg(p,"./img/tres.svg"),$(c).one("click",()=>{controler.pesquisar(i,r,c,p,e)})},async abas(e){let t=await GFN.getStorage("userTabs");t.userTabs.forEach(t=>{if(!1==t.crm)return;let a=document.createElement("div");a.classList.add("aba-Content"),a.setAttribute("aba-id",t.tag.toLowerCase()),a.setAttribute("data-id",t.tag.toLowerCase()),e.appendChild(a),injectPainel.header(a,!1,t.tag,t.chats.length);let l=document.createElement("div");l.classList.add("list-contatos"),l.setAttribute("list-users",t.tag.toLowerCase()),a.appendChild(l),controler.listControler(l,t.chats),controler.sortableAbasUsers(l)})}},showUser=async(e,t,a,l,n,i,d,s)=>{let r=document.createElement("div");r.classList.add("user"),r.setAttribute("userID",a),r.setAttribute("data-id",a),"after"==t?e.appendChild(r):e.prepend(r);let c=document.createElement("div");c.classList.add("camp1"),r.appendChild(c),l=await ACTION.picture(c,l,a);let o=document.createElement("div");o.setAttribute("tag","userLabels"),c.appendChild(o),ACTION.labels(r,o,a,n);let p=document.createElement("div");p.classList.add("camp2"),r.appendChild(p);let g=document.createElement("div");g.classList.add("camp2Name"),p.appendChild(g);let u=document.createElement("h1");u.setAttribute("tag","userName"),ACTION.nome(u,i,a),g.appendChild(u);let m=document.createElement("span");m.classList.add("remove-user"),GFN.initTitle(m,GFN.language.CRM_removeUser,"right"),m.addEventListener("click",e=>{controler.userRemove(e,r)}),g.appendChild(m),"inbox"==s&&m.classList.add("d-none"),GFN.svg(m,"../assets/images/svgs/tab_delete.svg");let v=document.createElement("div");v.classList.add("camp2Dados"),p.appendChild(v);let h=document.createElement("div");v.appendChild(h);let C=document.createElement("div");C.classList.add("guardado"),h.appendChild(C);let E=ACTION.notas(C,a),L=ACTION.agendamentos(C,a),b=document.createElement("div");b.classList.add("campUtilit"),v.appendChild(b),"inbox"==s&&b.classList.add("d-none");let M=document.createElement("div");b.appendChild(M);let f=document.createElement("div");f.classList.add("campVal"),M.appendChild(f),ACTION.valorNegocio(a,f);let A=document.createElement("div");A.setAttribute("tag","UserDateCRM"),M.appendChild(A),ACTION.data(A,d),E.addEventListener("click",e=>{e.stopPropagation(),card(a,l,o,n,i,"notas",d)}),L.addEventListener("click",e=>{e.stopPropagation(),card(a,l,o,n,i,"agendamentos",d)}),f.addEventListener("click",e=>{e.stopPropagation(),card(a,l,o,n,i,"valorNegocio")}),r.addEventListener("click",()=>card(a,l,o,n,i))},ACTION={async picture(e,t,a){e.querySelector('[tag="userPicture"]')?.remove();let l="";if(t&&"undefined"!=t){let n=document.createElement("img");n.setAttribute("tag","userPicture"),n.setAttribute("style","width:30px; border-radius:50%;"),n.setAttribute("src",t),e.prepend(n),l=n,n.onerror=function(){n?.remove();let t=document.createElement("span");t.setAttribute("tag","userPicture"),e.prepend(t),GFN.svg(t,"./img/userDefault.svg"),l=t,controler.updateUser(a,!1)}}else if(a.length>15){let i=document.createElement("span");i.setAttribute("tag","userPicture"),e.prepend(i),GFN.svg(i,"./img/groupDefault.svg"),l=i}else{let d=document.createElement("span");d.setAttribute("tag","userPicture"),e.prepend(d),GFN.svg(d,"./img/userDefault.svg"),l=d}return l},nome(e,t,a){t&&t.length<17?e.innerHTML=t:t?(e.setAttribute("title",t),e.innerHTML=t.slice(0,17)+"..."):(e.innerHTML="Carregando...",controler.updateUser(a,!1))},labels(e,t,a,l){if(t.innerHTML="",GFN.isBussines){if(l&&"undefined"!=l&&l.length>0){let n=0;l.forEach(e=>{if(n>=11)return;let a=GFN.labels.find(t=>t.id==e);if(!a||!a.hexColor)return;let l=document.createElement("span");l.innerHTML=`<svg width="18px" height="12px" viewBox="0 0 18 12" class="_2FjqD">
              <path fill="${a.hexColor}" d="M11.208,0.925H2.236C1.556,0.925,1,1.565,1,2.357V9.57C1,10.362,1.556,11,2.236,11h8.972 c0.414,0,0.785-0.237,1.007-0.604l2.701-4.433L12.215,1.53C11.993,1.162,11.622,0.925,11.208,0.925z"></path>
              </svg>`,t.appendChild(l),n++}),""==t.innerHTML&&GFN.svg(t,"./img/etiquetaVazia.svg")}else GFN.svg(t,"./img/etiquetaVazia.svg");$(t)?.on("click",n=>labelsEdit(n,e,t,a,l))}},notas(e,t){e.querySelector('div[tag="notas"]')?.remove();let a=notas_agendamentos.notas.find(e=>e.userID==t),l=document.createElement("div");return l.setAttribute("tag","notas"),a&&l.classList.add("activeInfo"),e.appendChild(l),GFN.svg(l,"../assets/images/svgs/note.svg"),l},agendamentos(e,t){e.querySelector('div[tag="agendamentos"]')?.remove();let a=notas_agendamentos.agendamentos.find(e=>e.userID==t),l=document.createElement("div");return l.setAttribute("tag","agendamentos"),a&&l.classList.add("activeInfo"),e.appendChild(l),GFN.svg(l,"../assets/images/svgs/calendario.svg"),l},async valorNegocio(e,t){t.innerHTML="";let a=await GFN.getStorage("valNegocio");a=(a=a.valNegocio).filter(t=>t.userID==e);let l=document.createElement("p"),n=0;a.forEach(e=>{n+=parseFloat(e.valor)}),l.innerHTML=n,0!=n&&(t.appendChild(l),GFN.svg(t,"./img/valor.svg"))},data(e,t){e.innerHTML="";let a=document.createElement("span");t?a.innerHTML=GFN.converterData(t):a.innerHTML=GFN.converterData(Date.now()),e.appendChild(a)}},labelsEdit=async(e,t,a,l,n)=>{e&&e.stopPropagation(),document.querySelector("#modalEtiqueta")&&document.querySelector("#modalEtiqueta")?.remove(),t.setAttribute("active","");let i=document.createElement("span");i.setAttribute("tag",l),i.setAttribute("role","tooltip"),i.setAttribute("data-show",""),i.setAttribute("id","modalEtiqueta"),i.classList.add("popper","show-slow"),i.style.backgroundColor="var(--panel-header-background)",document.querySelector(".tooltips").appendChild(i);let d=document.createElement("div");d.classList.add("etiquetaContent"),d.setAttribute("id","alc"),i.appendChild(d),Popper.createPopper(a,i,{placement:"right",modifiers:[{name:"offset",options:{offset:[0,5]}},]});let s=await WPP("labels");async function r(e){await WPP("addOrRemoveLabels",{label:{labelId:e.value,type:e.checked?"add":"remove"},id:l.length>15?l+"@g.us":l+"@c.us"}),e.checked?n.push(e.value):n=n.filter(t=>t!=e.value),GFN.tabsAtualize.etiquetas(l,n),controler.etiquetaUpdate(l,n,reload=!1),await WPP("getActiveChat","id")==l&&Content("initLabelChatActive")}n.map(e=>s.find(t=>t.hexColor&&t.id===e)).filter(Boolean).map(({id:e,name:t,hexColor:a})=>({id:e,name:t,color:a})),s.forEach(e=>{if(!e.hexColor)return;let t=document.createElement("input");t.setAttribute("type","checkbox"),t.setAttribute("value",e.id),t.setAttribute("id",`label-${e.id}`),n.includes(e.id)&&t.setAttribute("checked","checked");let a=document.createElement("label");a.setAttribute("for",`label-${e.id}`);let l=document.createElement("span");l.innerHTML=`<svg
                                xmlns="http://www.w3.org/2000/svg"
                                xmlns:xlink="http://www.w3.org/1999/xlink"
                                width="25"
                                zoomAndPan="magnify"
                                viewBox="0 0 36 36.000001"
                                preserveAspectRatio="xMidYMid meet"
                                version="1.0"
                            >
                                <defs>
                                    <clipPath id="813b2589cb">
                                        <path d="M 1.445312 5.324219 L 34.28125 5.324219 L 34.28125 29.402344 L 1.445312 29.402344 Z M 1.445312 5.324219 " clip-rule="nonzero" />
                                    </clipPath>
                                </defs>
                                <g clip-path="url(#813b2589cb)">
                                    <path
                                        fill="${e.hexColor}"
                                        d="M 26.730469 6.777344 C 26.101562 5.898438 25.074219 5.324219 23.90625 5.324219 L 4.910156 5.339844 C 3.003906 5.339844 1.457031 6.863281 1.457031 8.761719 L 1.457031 25.964844 C 1.457031 27.863281 3.003906 29.386719 4.910156 29.386719 L 23.90625 29.402344 C 25.074219 29.402344 26.101562 28.828125 26.730469 27.949219 L 34.269531 17.363281 Z M 26.730469 6.777344 "
                                        fill-opacity="1"
                                        fill-rule="nonzero"
                                    />
                                </g>
                            </svg> ${e.name}`,a.appendChild(t),a.appendChild(l),d.appendChild(a),t.addEventListener("change",()=>{r(t)})});let c=await GFN.getStorage("zoomCRM");c=c.zoomCRM,i.style.zoom=`${c}%`},card=async(e,t,a,l,n,i,d)=>{let s={async perfil(){u.innerHTML="",u.setAttribute("tag","active-perfil"),document.querySelector(".active")?.classList.remove("active"),document.querySelector(`span[item="${GFN.language.CRM_cardPerfil}"]`).classList.add("active");let l=await GFN.getStorage("perfil"),i=(l=(l=l.perfil).find(t=>t.userID==e))&&l?.produtos?l.produtos:[],d=document.createElement("div");d.classList.add("card-perfil-header"),u.appendChild(d);let s=document.createElement("div");s.classList.add("view"),d.appendChild(s),s.appendChild(t.cloneNode(!0));let r=document.createElement("span");r.innerHTML=GFN.numTransformWhats(e),s.appendChild(r);let c=a.cloneNode(!0);s.appendChild(c);let o=document.createElement("div");o.classList.add("dados"),d.appendChild(o);let p=ee(GFN.language.name,GFN.language.CRM_PerfilNomePlacehoolder,n,o),g=document.createElement("div");g.classList.add("divNas"),o.appendChild(g);let m=document.createElement("label");m.innerHTML=GFN.language.CRM_PerfilDataNas,g.appendChild(m);let v=document.createElement("input");v.setAttribute("type","date"),v.setAttribute("id","dataInput"),v.value=l?l.dataNascimento:"",m.appendChild(v);let h=document.createElement("label");h.innerHTML=GFN.language.CRM_PerfilSexo,g.appendChild(h);let C=document.createElement("div");h.appendChild(C);let E=document.createElement("label");E.innerHTML="M",C.appendChild(E);let L=document.createElement("input");L.classList.add("modalTabInput"),L.setAttribute("type","radio"),L.setAttribute("name","sexo"),L.setAttribute("value","M"),E.appendChild(L);let b=document.createElement("label");b.innerHTML="F",C.appendChild(b);let M=document.createElement("input");M.classList.add("modalTabInput"),M.setAttribute("type","radio"),M.setAttribute("name","sexo"),M.setAttribute("value","F"),b.appendChild(M),l&&("M"==l.sexo&&(L.checked=!0),"F"==l.sexo&&(M.checked=!0));let f=document.createElement("div");f.classList.add("userBussines"),o.appendChild(f);let A=l?l.empresa:"",_=ee(GFN.language.CRM_PerfilEmpresa,GFN.language.CRM_PerfilEmpresaPlace,A,f),T=l?l.cargo:"",y=ee(GFN.language.CRM_PerfilCargo,GFN.language.CRM_PerfilCargoPlace,T,f),w=document.createElement("div");w.setAttribute("tag","moreInfo"),u.appendChild(w);let R=document.createElement("div");R.classList.add("emails-card"),w.appendChild(R);let N=l?l.email:"",x=ee(GFN.language.CRM_PerfilEmail,GFN.language.CRM_PerfilEmailPlace,N,R),k=l?l.cidade:"",H=ee(GFN.language.CRM_PerfilEmailAdd,GFN.language.CRM_PerfilEmailAddPlace,k,R),P=document.createElement("div");P.classList.add("lead-card"),w.appendChild(P);let S=document.createElement("div");S.classList.add("dados-label"),P.appendChild(S);let I=document.createElement("label");I.innerHTML=GFN.language.CRM_PerfilOrigem,S.appendChild(I);let D=document.createElement("select");D.setAttribute("style","margin-top: 5px;"),I.appendChild(D),[GFN.language.CRM_PerfilOrigemDefault,"Whatsapp","Facebook","Instagram","Linkedim","TikTok","Youtube","Google","Site",GFN.language.CRM_PerfilOrigemForm,"CRM",GFN.language.CRM_PerfilOrigemOutros].forEach(e=>{let t=document.createElement("option");t.value=e,t.innerHTML=e,D.appendChild(t),l&&l.origemLead==e&&(t.selected=!0)});let q=document.createElement("div");q.classList.add("dates-card"),P.appendChild(q);let U=document.createElement("label");U.innerHTML=GFN.language.CRM_PerfilDataEntrada,q.appendChild(U);let F=document.createElement("input");F.setAttribute("type","date"),F.setAttribute("id","dataInput"),F.value=l?l.entrada:"",U.appendChild(F);let O=document.createElement("label");O.innerHTML=GFN.language.CRM_PerfilDataFechamento,q.appendChild(O);let z=document.createElement("input");z.setAttribute("type","date"),z.setAttribute("id","dataInput"),z.value=l?l.saida:"",O.appendChild(z);let V=document.createElement("div");V.classList.add("anotacoes-card"),w.appendChild(V);let B=document.createElement("div");B.classList.add("pretencoes-card"),B.innerHTML=GFN.language.CRM_PerfilPretencoes,V.appendChild(B);let j=document.createElement("div");j.classList.add("show-card"),B.appendChild(j),function e(t){for(let a of t){let l=document.createElement("div");l.classList.add("item-card"),j.appendChild(l);let n=document.createElement("span");n.setAttribute("tag","item-text"),n.innerHTML=a,l.appendChild(n);let i=document.createElement("span");i.setAttribute("tag","item-close"),GFN.svg(i,chrome.runtime.getURL("CRM/img/close.svg")),l.appendChild(i),i.addEventListener("click",()=>{l?.remove(),K(t=t.filter(e=>e!=a))})}}(i);let W=document.createElement("div");W.setAttribute("tag","insert-item"),B.appendChild(W);let Y=document.createElement("input");Y.placeholder=GFN.language.CRM_PerfilPretencoesPlace,W.appendChild(Y);let Z=document.createElement("button");Z.innerHTML=GFN.language.campain_Inserir,W.appendChild(Z),Y.addEventListener("keydown",e=>{"Enter"==e.key&&e.target.value.length>0&&X(i)}),Z.addEventListener("click",()=>{Y.value.length>0&&X(i)});let G=document.createElement("label");G.classList.add("card-observacoes"),G.innerHTML=GFN.language.CRM_PerfilObsPlace,V.appendChild(G);let J=document.createElement("textarea");J.value=l?l.observacoes:"",J.placeholder=GFN.language.CRM_placeAgenda,G.appendChild(J),p.addEventListener("blur",()=>{Q()}),v.addEventListener("blur",()=>{K(i)}),L.addEventListener("blur",()=>{K(i)}),M.addEventListener("blur",()=>{K(i)}),_.addEventListener("blur",()=>{K(i)}),y.addEventListener("blur",()=>{K(i)}),x.addEventListener("blur",()=>{K(i)}),H.addEventListener("blur",()=>{K(i)}),D.addEventListener("change",()=>{K(i)}),F.addEventListener("blur",()=>{K(i)}),z.addEventListener("blur",()=>{K(i)}),J.addEventListener("blur",()=>{K(i)});let K=async t=>{if(await GFN.isFree()){GFN.modal_CRM_Free();return}let a={userID:e,dataNascimento:v.value,sexo:L.checked?L.value:M.value,empresa:_.value,cargo:y.value,email:x.value,cidade:H.value,origemLead:D.value,entrada:F.value,saida:z.value,produtos:t,observacoes:J.value},l=await GFN.getStorage("perfil");(l=(l=l.perfil).filter(t=>t.userID!=e)).push(a),chrome.storage.local.set({perfil:l})},Q=async()=>{if(await GFN.isFree()){GFN.modal_CRM_Free();return}let t={id:e,name:p.value},a=await GFN.getStorage("contatos");(a=(a=a.contatos).filter(t=>t.id!=e)).push(t),chrome.storage.local.set({contatos:a}),await WPP("setNameUser",t),controler.userUpdateNome(t)};async function X(e){if(await GFN.isFree()){GFN.modal_CRM_Free();return}let t=document.createElement("div");t.classList.add("item-card"),j.appendChild(t);let a=document.createElement("span");a.setAttribute("tag","item-text"),a.innerHTML=Y.value,t.appendChild(a);let l=document.createElement("span");l.setAttribute("tag","item-close"),GFN.svg(l,chrome.runtime.getURL("CRM/img/close.svg")),t.appendChild(l),l.addEventListener("click",()=>{t?.remove(),K(e=e.filter(e=>e!==Y.value))}),e.push(Y.value),Y.value="",K(e)}function ee(e,t,a,l){let n=document.createElement("div");n.classList.add("dados-label"),l.appendChild(n);let i=document.createElement("label");i.innerHTML=e,n.appendChild(i);let d=document.createElement("input");return d.value=a,d.placeholder=t,n.appendChild(d),d}},async notas(){u.innerHTML="",u.setAttribute("tag","active-notas"),document.querySelector(".active")?.classList.remove("active"),document.querySelector(`span[item="${GFN.language.CRM_cardNotas}"]`).classList.add("active");let t=async(t,a,l)=>{let n=await GFN.getStorage("notes");if(n=(n=n.notes).filter(e=>e.id!=t),chrome.storage.local.set({notes:n},()=>{a.remove()}),0==n.length){let i=document.createElement("div");i.classList.add("note-notNote"),l.appendChild(i);let s=document.createElement("p");s.innerHTML=GFN.language.notes_empty,i.appendChild(s)}GFN.tabsAtualize.updateUser(!1),controler.updateUser(e,{dataEntrada:d})},a=await GFN.getStorage("notes"),l=a.notes;a=(a=a.notes).filter(t=>t.userID==e);let n=document.createElement("main");u.appendChild(n);let i=document.createElement("div");if(i.classList.add("notes-list"),n.appendChild(i),0==a.length){let r=document.createElement("div");r.classList.add("note-notNote"),i.appendChild(r);let c=document.createElement("p");c.innerHTML=GFN.language.notes_empty,r.appendChild(c)}a.forEach(e=>{let a=document.createElement("div");a.classList.add("waTidy_note_item"),i.appendChild(a);let l=document.createElement("p");l.innerText=e.text,a.appendChild(l);let n=document.createElement("span"),d=new Date(e.id),s=`${d.toLocaleDateString()} at ${d.toLocaleTimeString()}`;n.innerText=s,l.appendChild(n);let r=document.createElement("div");r.setAttribute("style","display: flex;cursor: pointer;"),a.appendChild(r);let c=document.createElement("span");GFN.svg(c,chrome.runtime.getURL("assets/images/svgs/tab_delete.svg")),c.addEventListener("click",()=>t(e.id,a,i)),r.appendChild(c);let o=document.createElement("span");GFN.svg(o,chrome.runtime.getURL("assets/images/svgs/fileCopy.svg")),o.addEventListener("click",()=>GFN.textToClipboard(e.text)),o.classList.add("copy"),r.appendChild(o)});let o=document.createElement("div");o.classList.add("note-newNote"),n.appendChild(o);let p=document.createElement("button");o.appendChild(p),p.innerHTML=GFN.language.added,GFN.svg(p,chrome.runtime.getURL("CRM/img/NewNote.svg")),p.addEventListener("click",async()=>{if(await GFN.isFree()){GFN.modal_CRM_Free();return}i?.remove(),o?.remove();let t=document.createElement("div");t.classList.add("create-note"),n.appendChild(t);let a=document.createElement("textarea");a.placeholder=GFN.language.CRM_placeNote,t.appendChild(a);let r=document.createElement("div");r.classList.add("create-note-footer"),t.appendChild(r);let c=document.createElement("button");c.setAttribute("style","background-color: var(--btnNot);"),c.addEventListener("click",()=>{s.notas()}),c.innerHTML="Cancelar",r.appendChild(c);let p=document.createElement("button");p.innerHTML="Salvar",r.appendChild(p),p.addEventListener("click",()=>{let t={id:Date.now(),userID:e,text:a.value};l.push(t),chrome.storage.local.set({notes:l}),s.notas(),controler.updateUser(e,{dataEntrada:d})})})},async mensagensAgendadas(){u.innerHTML="",u.setAttribute("tag","active-mensagens-agendadas"),document.querySelector(".active")?.classList.remove("active"),document.querySelector(`span[item="${GFN.language.CRM_cardMsgAgendadas}"]`).classList.add("active");let t=async(t,a,l)=>{let n=await GFN.getStorage("agendaMsg");if(n=(n=n.agendaMsg).filter(e=>e.id!=t),chrome.storage.local.set({agendaMsg:n},()=>{a.remove()}),0==n.length){let i=document.createElement("div");i.classList.add("note-notNote"),l.appendChild(i);let s=document.createElement("p");s.innerHTML=GFN.language.notes_empty,i.appendChild(s)}GFN.tabsAtualize.updateUser(!1),controler.updateUser(e,{dataEntrada:d})},a=await GFN.getStorage("agendaMsg"),l=a.agendaMsg;a=(a=a.agendaMsg).filter(t=>t.userID==e);let n=document.createElement("main");u.appendChild(n);let i=document.createElement("div");if(i.classList.add("notes-list"),n.appendChild(i),0==a.length){let r=document.createElement("div");r.classList.add("note-notNote"),i.appendChild(r);let c=document.createElement("p");c.innerHTML=GFN.language.agenda_empty,r.appendChild(c)}a.forEach(e=>{let a=document.createElement("div");a.classList.add("waTidy_note_item"),i.appendChild(a);let l=document.createElement("p");l.innerText=e.text,a.appendChild(l);let n=document.createElement("span"),d=new Date(e.id),s=`${d.toLocaleDateString()} at ${d.toLocaleTimeString()}`;n.innerText=s,l.appendChild(n);let r=document.createElement("div");r.setAttribute("style","display: flex;cursor: pointer;"),a.appendChild(r);let c=document.createElement("span");GFN.svg(c,chrome.runtime.getURL("assets/images/svgs/tab_delete.svg")),c.addEventListener("click",()=>t(e.id,a,i)),r.appendChild(c);let o=document.createElement("span");GFN.svg(o,chrome.runtime.getURL("assets/images/svgs/fileCopy.svg")),o.addEventListener("click",()=>GFN.textToClipboard(e.text)),o.classList.add("copy"),r.appendChild(o)});let o=document.createElement("span");o.setAttribute("tag","agenda-alert"),o.innerHTML=GFN.language.agendarMsg_alert,n.appendChild(o);let p=document.createElement("div");p.classList.add("note-newNote"),n.appendChild(p);let g=document.createElement("button");p.appendChild(g),g.innerHTML=GFN.language.added,GFN.svg(g,chrome.runtime.getURL("CRM/img/NewNote.svg")),g.addEventListener("click",async()=>{if(await GFN.isFree()){GFN.modal_CRM_Free();return}i?.remove(),p?.remove();let t=document.createElement("div");t.classList.add("create-note"),n.appendChild(t);let a=document.createElement("textarea");a.placeholder=GFN.language.CRM_placeAgenda,t.appendChild(a);let r=document.createElement("p");r.classList.add("waTidy_modal_agendar"),r.innerText=GFN.language.reminder_date,t.appendChild(r);let c=new Date;c.setMinutes(c.getMinutes()+5);let o=10>c.getDate()?"0"+c.getDate():c.getDate(),g=c.getMonth()+1<10?"0"+(c.getMonth()+1):c.getMonth()+1,u=c.getFullYear(),m=10>c.getHours()?"0"+c.getHours():c.getHours(),v=10>c.getMinutes()?"0"+c.getMinutes():c.getMinutes(),h=`${u}-${g}-${o}`,C=`${m}:${v}`,E=document.createElement("input");E.setAttribute("type","date"),E.setAttribute("id","dataInput"),E.setAttribute("min",h),E.value=h,t.appendChild(E);let L=document.createElement("p");L.classList.add("waTidy_modal_agendar"),L.innerText=GFN.language.reminder_time,t.appendChild(L);let b=document.createElement("input");b.setAttribute("type","time"),b.setAttribute("id","timerInput"),b.setAttribute("value",C),t.appendChild(b);let M=document.createElement("div");M.classList.add("create-note-footer"),t.appendChild(M);let f=document.createElement("button");f.setAttribute("style","background-color: var(--btnNot);"),f.addEventListener("click",()=>{s.notas()}),f.innerHTML="Cancelar",M.appendChild(f);let A=document.createElement("button");A.innerHTML="Salvar",M.appendChild(A),A.addEventListener("click",()=>{let t={id:Date.now(),userID:e,text:a.value,timer:b.value,data:E.value};l.push(t),chrome.storage.local.set({agendaMsg:l}),s.mensagensAgendadas(),controler.updateUser(e,{dataEntrada:d})})})},async valorNegocio(){u.innerHTML="",u.setAttribute("tag","active-valor-negocio"),document.querySelector(".active")?.classList.remove("active"),document.querySelector(`span[item="${GFN.language.CRM_cardValNegocio}"]`).classList.add("active");let t=async(e,t,a)=>{let l=await GFN.getStorage("valNegocio");if(l=(l=l.valNegocio).filter(t=>t.id!=e),chrome.storage.local.set({valNegocio:l},()=>{t.remove()}),0==l.length){let n=document.createElement("div");n.classList.add("note-notNote"),a.appendChild(n);let i=document.createElement("p");i.innerHTML=GFN.language.CRM_emptyValNegocio,n.appendChild(i)}s.valorNegocio(),C()},a=await GFN.getStorage("valNegocio"),l=a.valNegocio;a=(a=a.valNegocio).filter(t=>t.userID==e);let n=document.createElement("main");u.appendChild(n);let i=document.createElement("div");if(i.setAttribute("style","max-height: 455px;"),i.classList.add("notes-list"),n.appendChild(i),a.forEach(e=>{let a=document.createElement("div");a.classList.add("waTidy_note_item"),i.appendChild(a);let l=document.createElement("p");l.innerText=e.text,a.appendChild(l);let n=document.createElement("span"),d=new Date(e.id),s=`${d.toLocaleDateString()} at ${d.toLocaleTimeString()}`;n.innerText=s,l.appendChild(n);let r=document.createElement("div");r.setAttribute("style","display: flex;cursor: pointer;"),r.classList.add("valorNegocio-val"),a.appendChild(r);let c=document.createElement("div");r.appendChild(c),GFN.svg(c,"./img/valor.svg");let o=document.createElement("span");o.innerHTML=parseFloat(e.valor),c.appendChild(o);let p=document.createElement("span");GFN.svg(p,chrome.runtime.getURL("assets/images/svgs/tab_delete.svg")),p.addEventListener("click",()=>t(e.id,a,i)),r.appendChild(p)}),0==a.length){let d=document.createElement("div");d.classList.add("note-notNote"),i.appendChild(d);let r=document.createElement("p");r.innerHTML=GFN.language.CRM_emptyValNegocio,d.appendChild(r)}else{let c=document.createElement("div");c.classList.add("valorNegocio-total"),n.appendChild(c);let o=document.createElement("span");o.setAttribute("tag","total-text"),o.innerHTML=GFN.language.CRM_valTotal,c.appendChild(o);let p=document.createElement("span");p.setAttribute("tag","total-val"),GFN.svg(p,"./img/valor.svg"),c.appendChild(p);let g=document.createElement("p"),m=0;a.forEach(e=>{m+=parseFloat(e.valor)}),g.innerHTML=m,p.appendChild(g)}let v=document.createElement("div");n.appendChild(v);let h=document.createElement("button");function C(){let t=document.querySelectorAll(`div[userid="${e}"]`);t.forEach(t=>{ACTION.valorNegocio(e,t.querySelector(".campVal"))})}v.appendChild(h),v.classList.add("note-newNote"),h.innerHTML=GFN.language.added,GFN.svg(h,chrome.runtime.getURL("CRM/img/NewNote.svg")),h.addEventListener("click",async()=>{if(await GFN.isFree()){GFN.modal_CRM_Free();return}i?.remove(),v?.remove(),document.querySelector(".valorNegocio-total")?.remove();let t=document.createElement("div");t.classList.add("create-note"),n.appendChild(t);let a=document.createElement("div");a.classList.add("create-valorNegocio"),t.appendChild(a);let d=document.createElement("div");d.setAttribute("tag","descMain"),a.appendChild(d);let r=document.createElement("label");r.textContent="Descri\xe7\xe3o",d.appendChild(r);let c=document.createElement("input");c.type="text",c.placeholder="Adicione uma breve descri\xe7\xe3o",d.appendChild(c);let o=document.createElement("div");o.setAttribute("tag","valMain"),a.appendChild(o);let p=document.createElement("label");p.textContent="Valor",o.appendChild(p);let g=document.createElement("input");g.setAttribute("tag","inp-val"),g.type="number",g.placeholder="Adicione o Valor Negociado",o.appendChild(g);let u=document.createElement("div");u.classList.add("create-note-footer"),t.appendChild(u);let m=document.createElement("button");m.setAttribute("style","background-color: var(--btnNot);"),m.addEventListener("click",()=>{s.valorNegocio()}),m.innerHTML="Cancelar",u.appendChild(m);let h=document.createElement("button");h.innerHTML="Salvar",u.appendChild(h),h.addEventListener("click",()=>{let t={id:Date.now(),userID:e,text:c.value,valor:g.value};l.push(t),chrome.storage.local.set({valNegocio:l}),s.valorNegocio(),C()})})}},[r,c,o]=GFN.modal(!1);r.setAttribute("tag","card"),c.setAttribute("tag","card-content"),r.classList.add("show-slow");let p=document.createElement("div");c.appendChild(p);let g=document.createElement("div");g.classList.add("card-header"),p.appendChild(g),[GFN.language.CRM_cardPerfil,GFN.language.CRM_cardNotas,GFN.language.CRM_cardMsgAgendadas,GFN.language.CRM_cardValNegocio].forEach(e=>{let t=document.createElement("span");switch(t.setAttribute("item",e),t.innerHTML=e,g.appendChild(t),e){case GFN.language.CRM_cardPerfil:t.addEventListener("click",()=>{s.perfil()});break;case GFN.language.CRM_cardNotas:t.addEventListener("click",()=>{s.notas()});break;case GFN.language.CRM_cardMsgAgendadas:t.addEventListener("click",()=>{s.mensagensAgendadas()});break;case GFN.language.CRM_cardValNegocio:t.addEventListener("click",()=>{s.valorNegocio()})}});let u=document.createElement("div");switch(p.appendChild(u),i){case"notas":s.notas();break;case"agendamentos":s.mensagensAgendadas();break;case"valorNegocio":s.valorNegocio();break;default:s.perfil()}};